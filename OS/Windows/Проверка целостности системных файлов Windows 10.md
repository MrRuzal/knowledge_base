#Windows #Windows10
![](https://telegra.ph/file/cdc8c3f49ab42735489f3.png)

Системные файлы операционной системы Windows 10 ежедневно подвергаются опасности. Если автоматической защите или антивирусу не удается справиться с угрозой, то файл становится потенциальной угрозой для системы. Он может стать зараженным (будучи потенциальным разносчиком «заразы») или поврежденным. Если с первым вариантом все понятно, то со вторым необходимо понимать тонкости системы и уметь восстанавливать файлы.

Для проверки целостности системных файлов в Windows 10 используется два компонента под названием SFC.ext и DISM.exe. Они способы проверить целостность системы и автоматически восстановить поврежденные файлы. Кроме того, есть еще один системный продукт Repair-WindowsImage – он работает в командной строке, используя функционал DISM.

Используя вышеуказанные программные обеспечения, можно добиться отличных результатов при выявлении дефектов файлов. Однако стоит помнить, что при восстановлении системных файлов также затрагиваются и пользовательские изменения: установка ресурсов, преобразования системы и другие надстройки буду отменены.

### Исследование целостности системы и исправление ее с помощью SFC

Каждый опытный пользователь сталкивался с командой проверки целостности системы sfc /scannow, позволяющей автоматически проверить и исправить поврежденные файлы в ОС Windows. Ее запуск осуществляется в командной строке, а время сканирования в среднем занимает около 5 минут.

Впрочем, меньше слов, давайте рассмотрим, как все это работает на примере:

1. Открываем меню «Пуск» и вводим в поисковой запрос «Командная строка». В открывшемся окне сбоку выбираем «Запуск от имени администратора».

![](https://telegra.ph/file/722fc5f7ec6f8eef71e18.png)

Во вновь запущенном окне вводим следующий текст: sfc /scannow и ожидаем окончания сканирования. На моем компьютере это заняло примерно 10 минут.

![](https://telegra.ph/file/22d2eab23c45e54008c3b.png)

После завершения сканирования, система на моем компьютере выявила некоторые поврежденные файлы, но не смогла их восстановить.

![](https://telegra.ph/file/7913fa5e9df3f4eac8f36.png)

Недостатком команд scf /scannow и sfc /scanfile является то, что они могут исправлять только тот файл, который в данный момент не используется. Для решения проблемы с работающим файлом обычно используется запуск командной строки в среде восстановления Windows 10.

### Запуск SFC в среде восстановления

Для загрузки системы в среде восстановления воспользуйтесь одним из нижеуказанных способов:

1. Откроем параметры путем сочетания клавиш «Win+I», перейдем в раздел «Обновление и безопасность», затем кликнем на кнопку «Перезагрузить сейчас» в окне «Восстановление».

![](https://telegra.ph/file/fe188e73a3934c52425a9.png)

1. Загрузимся с уже созданного диска восстановления Windows.
2. Загрузимся с любого установочного диска или загрузочной флэшки для Windows.

После загрузки в среде восстановления вводим следующие параметры в командную строку, соблюдая последовательность:

1. diskpart.
2. list volume.
3. exit.
4. sfc /scannow /offbootdir = C:\ /offwindir = C:\Program Files, где C – локальный диск, с установленной системой, а диск C:\Program Files – путь к папке.

![](https://telegra.ph/file/76b8d8ff79a2a299f87a5.png)

Описываемый метод проводит глубокое исследование целостности системы, в ходе которого команда SFC исправляет все неисправности. По окончании сканирования Windows 10 автоматически перезагрузится и запустится в обычном режиме.

### Сканирование и восстановление системы с использованием DISM.exe

В том случае, если компонент системы SFC не может справиться со своей работой, на помощь приходит DISM.exe, позволяющий закончить начатое восстановление. Его работа заключается в сканировании и обслуживании системы, последовательном исправлении самых важных проблем. Кроме того, DISM может найти те неисправности, которых SFC даже не заметил.

Для запуска утилиты выполняем следующие действия:

1. Открываем уже известную нам командную строку через меню «Пуск»

![](https://telegra.ph/file/ed9221fd721850f48ee0d.png)

Далее вводим указанную команду: dism /Online /Cleanup-Image /CheckHealth – она необходима для того, чтобы сформировать сведения о состоянии системы. Она сканирует незначительные параметры и проверяет компоненты на неисправность

![](https://telegra.ph/file/b715733b7c6afed38c86a.png)

Следующая команда dism /Online /Cleanup-Image /ScanHealth уже исследует и проверяет целостность системных файлов.

![](https://telegra.ph/file/b7d390ae0c65e581a4469.png)

dism /Online /Cleanup-Image /RestoreHealth – просканирует, а затем автоматически восстановит все компоненты ОС.

![](https://telegra.ph/file/a8b78cf6ec72e5f067ad1.png)

> Вышеуказанные операции сохраняются в журнал выполненных действий, который вы можете посмотреть в следующих папках: Windows\Logs\CBS\CBS.log или Windows\Logs\DISM\dism.log.

В том случае, если на вашем компьютере по какой-либо причине не работает восстановление хранилища компонентов, то вы можете воспользоваться файлом install.wim (иногда расширение .esd). Его можно найти на смонтированном образе Windows 10, который вы можете скачать с официального сайта Microsoft.

Сам процесс осуществляется при помощи команды:

> dism /Online /Cleanup-Image /RestoreHealth /Source: wim:путь_к_файлу:1 /limitaccess

При учете расширения .eds замените все элементы wim на eds.

Запустить сканирование операционной системы с помощью команды DISM можно и в Windows PowerShell. Просто запустите программу через меню «Пуск» от имени администратора и введите одну из следующих команд:

- Repair – WindowsImage – Online – ScanHealth. – осуществляет поиск неисправностей системных элементов.
- Repair – WindowsImage – Online – RestoreHealth – осуществляет сканирование, а затем удаляет дефекты системы.

Как видите, проверить целостность системных файлов в Windows 10 не так и сложно. Требуется лишь следовать инструкция и смотреть реакцию на выполнение определенных команд. Иногда вышеуказанные способы не срабатывают не потому, что вы что-то не так делаете, а потому что система имеет более глобальные неисправности. Какие бывают еще неисправности и как их решить читайте в следующем разделе.

### Дополнительная информация

Если при использовании операции SFC ваша система обнаружила дефекты системы сразу же после обновления ОС, то вынужден вас огорчить. Исправление ошибки возможно только при переустановке системного образа. Если же неисправность связана с видеокартой, то обычно в этом виновен файл opencl.dll, который лучше всего оставить без изменений.

В случае с командой sfc /scannow, которой не удается выполнить восстановление системных файлов, а восстановление хранилища также не дает никаких решений, следует обратиться к журналу CBS.log. Для этого экспортируйте все сведения из журнала в текстовый файл sfc с помощью следующей команды:

> findstr /c:»[SR]» %windir%\Logs\CBS\CBS.log >»%userprofile%\Desktop\sfc.txt»

Используя указанную команду, вы сможете посмотреть какие именно системные файлы были повреждены.